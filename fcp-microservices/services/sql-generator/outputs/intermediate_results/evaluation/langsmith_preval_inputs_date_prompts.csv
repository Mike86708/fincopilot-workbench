input,history,dialect,table_info,PROMPT_TEMPLATE_ID,PROMPT_ID,GOLDEN_SQL_QUERY,USER_PROMPT
"what is the total amount of overdue invoices for subsidiary DoorDash, Inc. in this month?
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",9,PRMT_00009,"SELECT   ds.subsidiary_name,  SUM(ai.INVOICE_DUE_AMOUNT) AS total_overdue_amount FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON      ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.IS_INVOICE_DUE = TRUE    
AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('month', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('month', DATEADD(month, 1, CURRENT_DATE())) 
group by ds.subsidiary_name LIMIT 1000;","what is the total amount of overdue invoices for subsidiary DoorDash, Inc. in this month?"
"provide the total amount of invoices for each brand Unilever in this month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",10,PRMT_00010,"SELECT      c.BRAND,     SUM(i.INVOICED_AMOUNT) AS total_invoiced_amount FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE i JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER c ON      i.AR_CUSTOMER_FK = c.AR_CUSTOMER_PK WHERE      c.BRAND = 'Unilever'     AND i.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('month', CURRENT_DATE())     AND i.INVOICE_TRANSACTION_DATE < DATE_TRUNC('month', DATEADD(month, 1, CURRENT_DATE())) GROUP BY      c.BRAND LIMIT 1000;",provide the total amount of invoices for each brand Unilever in this month
"list all invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in last 6 months and subsidiary DoorDash, Inc.
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",11,PRMT_00011,"SELECT   ac.customer_name,ds.subsidiary_name, ac.brand,  ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.INVOICE_DUE_AMOUNT,     ai.PAYMENT_RECEIVED_AMOUNT,     ai.CREDIT_MEMO_APPLIED_AMOUNT,     ai.INVOICE_AGING_BUCKET,     ai.INVOICE_MEMO FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK
JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds  ON      ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK  
WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.SUBSIDIARY_FK IN ('c4ca4238a0b923820dcc509a6f75849b')  and ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -6, CURRENT_DATE()) 
ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","list all invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in last 6 months and subsidiary DoorDash, Inc."
"provide the details of aging for each subsidiary DoorDash, Inc. in last year
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",13,PRMT_00013,"SELECT      s.SUBSIDIARY_NAME,     i.INVOICE_AGING_BUCKET,     COUNT(*) AS invoice_count FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE i JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY s ON      i.SUBSIDIARY_FK = s.SUBSIDIARY_PK WHERE      s.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND i.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('YEAR', DATEADD(YEAR, -1, CURRENT_DATE()))     AND i.INVOICE_TRANSACTION_DATE < DATE_TRUNC('YEAR', CURRENT_DATE()) GROUP BY      s.SUBSIDIARY_NAME,      i.INVOICE_AGING_BUCKET ORDER BY      s.SUBSIDIARY_NAME,      i.INVOICE_AGING_BUCKET LIMIT 1000;","provide the details of aging for each subsidiary DoorDash, Inc. in last year"
"what is the total amount of overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. for last quarter?
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",16,PRMT_00016,"WITH last_quarter AS (     SELECT          DATE_TRUNC('QUARTER', DATEADD(QUARTER, -1, CURRENT_DATE())) AS start_date,         DATE_TRUNC('QUARTER', CURRENT_DATE()) - INTERVAL '1 SECOND' AS end_date ) SELECT  ds.subsidiary_name,ac.customer_name,    SUM(ai.INVOICE_DUE_AMOUNT) AS total_overdue_amount FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK JOIN      last_quarter lq ON ai.INVOICE_TRANSACTION_DATE BETWEEN lq.start_date AND lq.end_date WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.IS_INVOICE_DUE = TRUE 
group by ds.subsidiary_name,ac.customer_name LIMIT 1000;","what is the total amount of overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. for last quarter?"
"show me the invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the last month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",17,PRMT_00017,"SELECT  ac.customer_name,    ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.INVOICE_DUE_AMOUNT FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('month', DATEADD(month, -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('month', CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","show me the invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the last month"
"list the overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the last month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",20,PRMT_00020,"SELECT     ac.customer_name, ai.INVOICE_NUMBER,      ai.INVOICE_DUE_DATE,      ai.INVOICE_DUE_AMOUNT,      ai.INVOICE_AGING_BUCKET  FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac  ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.IS_INVOICE_DUE = TRUE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('MONTH', DATEADD(MONTH, -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('MONTH', CURRENT_DATE()) ORDER BY      ai.INVOICE_DUE_DATE DESC LIMIT 1000;","list the overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the last month"
"list the overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. and last 6 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",21,PRMT_00021,"SELECT   ac.customer_name,ds.subsidiary_name,   ai.INVOICE_NUMBER,     ai.INVOICE_DUE_DATE,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_IN_DAYS FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.IS_INVOICE_DUE = TRUE     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -6, CURRENT_DATE()) ORDER BY      ai.INVOICE_DUE_DATE DESC LIMIT 1000;","list the overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. and last 6 months"
what is the total amount of payments received in last year?,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",27,PRMT_00027,"SELECT SUM(PAYMENT_RECEIVED_AMOUNT) AS total_payments_received FROM FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE WHERE INVOICE_TRANSACTION_DATE >= DATE_TRUNC('YEAR', DATEADD(YEAR, -1, CURRENT_DATE()))   AND INVOICE_TRANSACTION_DATE < DATE_TRUNC('YEAR', CURRENT_DATE()) LIMIT 1000;",what is the total amount of payments received in last year?
"list all overdue invoices for subsidiary DoorDash, Inc. in last 6 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",30,PRMT_00030,"SELECT  ds.SUBSIDIARY_NAME,    ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_DUE_DATE,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_BUCKET,      FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON      ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.IS_INVOICE_DUE = TRUE     AND ai.INVOICE_DUE_DATE >= DATEADD(MONTH, -6, CURRENT_DATE()) ORDER BY      ai.INVOICE_DUE_DATE DESC LIMIT 1000;","list all overdue invoices for subsidiary DoorDash, Inc. in last 6 months"
"what is the total amount of credit memos for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in this quarter?
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",31,PRMT_00031,"WITH current_quarter AS (     SELECT          DATE_TRUNC('quarter', CURRENT_DATE()) AS quarter_start,         DATEADD(day, -1, DATEADD(quarter, 1, DATE_TRUNC('quarter', CURRENT_DATE()))) AS quarter_end ) SELECT  ac.customer_name,    SUM(ai.CREDIT_MEMO_APPLIED_AMOUNT) AS total_credit_memos FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.INVOICE_TRANSACTION_DATE BETWEEN (SELECT quarter_start FROM current_quarter) AND (SELECT quarter_end FROM current_quarter) group by ac.customer_name LIMIT 1000;","what is the total amount of credit memos for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in this quarter?"
show me the memos for arsd ticket# 115936 in last 3 months,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",33,PRMT_00033,"SELECT    ai.ARSD_TICKET_NUMBER,  ai.INVOICE_MEMO  FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai WHERE      ai.ARSD_TICKET_NUMBER = '115936'     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -3, CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;",show me the memos for arsd ticket# 115936 in last 3 months
"list all overdue invoices and payments received for subsidiary DoorDash, Inc. in last 3 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",44,PRMT_00044,"SELECT   ds.subsidiary_name,   ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_DUE_DATE,     ai.INVOICE_DUE_AMOUNT,     ai.PAYMENT_RECEIVED_AMOUNT,     ai.INVOICE_AGING_BUCKET FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON      ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.IS_INVOICE_DUE = TRUE     AND ai.INVOICE_DUE_DATE >= DATEADD(MONTH, -3, CURRENT_DATE()) ORDER BY      ai.INVOICE_DUE_DATE DESC LIMIT 1000;","list all overdue invoices and payments received for subsidiary DoorDash, Inc. in last 3 months"
"what is the total amount of payments received from customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the last quarter?
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",45,PRMT_00045,"WITH last_quarter AS (     SELECT          DATE_TRUNC('QUARTER', DATEADD(QUARTER, -1, CURRENT_DATE())) AS start_date,         DATE_TRUNC('QUARTER', CURRENT_DATE()) - INTERVAL '1 SECOND' AS end_date ) SELECT   ac.customer_name,   SUM(ai.PAYMENT_RECEIVED_AMOUNT) AS total_payments_received FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      last_quarter lq ON      ai.INVOICE_TRANSACTION_DATE BETWEEN lq.start_date AND lq.end_date WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea' group by  ac.customer_name LIMIT 1000;","what is the total amount of payments received from customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the last quarter?"
"list all invoices for brand Unilever in business unit Marketplace for last month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}, {'entity_type': 'business_unit', 'entity_name': 'Marketplace', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",46,PRMT_00046,"WITH last_month AS (     SELECT DATE_TRUNC('month', DATEADD(month, -1, CURRENT_DATE())) AS start_date,            DATE_TRUNC('month', CURRENT_DATE()) AS end_date ) SELECT    ac.brand, bu.business_unit_name, ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT bu ON ai.BUSINESS_UNIT_FK = bu.BUSINESS_UNIT_PK JOIN      last_month lm ON ai.INVOICE_TRANSACTION_DATE >= lm.start_date AND ai.INVOICE_TRANSACTION_DATE < lm.end_date WHERE      ac.BRAND = 'Unilever'     AND bu.BUSINESS_UNIT_PK IN ('c4ca4238a0b923820dcc509a6f75849b') ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;",list all invoices for brand Unilever in business unit Marketplace for last month
"list all memos for arsd ticket# 115936 in brand Unilever for this quarter
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",47,PRMT_00047,"SELECT   ac.BRAND,   ai.INVOICE_MEMO  FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac      ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ai.ARSD_TICKET_NUMBER = '115936'     AND ac.BRAND = 'Unilever'     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('quarter', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATEADD(quarter, 1, DATE_TRUNC('quarter', CURRENT_DATE())) LIMIT 1000;",list all memos for arsd ticket# 115936 in brand Unilever for this quarter
"show me the total payments received from customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. for last month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",50,PRMT_00050,"WITH last_month AS (     SELECT DATE_TRUNC('month', DATEADD(month, -1, CURRENT_DATE())) AS start_date,            DATE_TRUNC('month', CURRENT_DATE()) - INTERVAL '1 day' AS end_date ) SELECT ac.customer_name,ds.subsidiary_name,SUM(ai.PAYMENT_RECEIVED_AMOUNT) AS total_payments_received FROM FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'   AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')   AND ai.INVOICE_TRANSACTION_DATE BETWEEN (SELECT start_date FROM last_month) AND (SELECT end_date FROM last_month) 
group by ac.customer_name,ds.subsidiary_name LIMIT 1000;","show me the total payments received from customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. for last month"
"what is the total amount of credit memos for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. for last quarter?
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",52,PRMT_00052,"WITH last_quarter AS (     SELECT          DATE_TRUNC('QUARTER', DATEADD(QUARTER, -1, CURRENT_DATE())) AS start_date,         DATE_TRUNC('QUARTER', CURRENT_DATE()) - INTERVAL '1 SECOND' AS end_date ) SELECT  ac.customer_name,ds.subsidiary_name ,   SUM(CREDIT_MEMO_APPLIED_AMOUNT) AS total_credit_memos FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.INVOICE_TRANSACTION_DATE BETWEEN (SELECT start_date FROM last_quarter) AND (SELECT end_date FROM last_quarter) 
group by ac.customer_name,ds.subsidiary_name 
LIMIT 1000;","what is the total amount of credit memos for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. for last quarter?"
"what is the total of memos for arsd ticket# 115936 in brand Unilever for last month?
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",53,PRMT_00053,"SELECT     ac.BRAND, SUM(ai.INVOICE_MEMO) AS total_memos FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ai.ARSD_TICKET_NUMBER = '115936'     AND ac.BRAND = 'Unilever'     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('month', DATEADD(month, -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('month', CURRENT_DATE()) group by ac.BRAND LIMIT 1000;",what is the total of memos for arsd ticket# 115936 in brand Unilever for last month?
"list all unpaid invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. in last year
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",56,PRMT_00056,"SELECT    ac.customer_name,  ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b' )     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('YEAR', DATEADD(YEAR, -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('YEAR', CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","list all unpaid invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. in last year"
"show me the summary of unpaid invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. in last month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",59,PRMT_00059,"SELECT    ds.subsidiary_name,ac.customer_name,  ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_BUCKET,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b')     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('month', DATEADD(month, -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('month', CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","show me the summary of unpaid invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in subsidiary DoorDash, Inc. in last month"
"list all unpaid invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in brand Unilever in last 3 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",61,PRMT_00061,"SELECT   ac.customer_name,ac.brand,   ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac      ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ac.BRAND = 'Unilever'     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -3, CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","list all unpaid invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in brand Unilever in last 3 months"
"list unpaid invoices for customer id 2200159 in subsidiary DoorDash, Inc. in this quarter
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_id', 'entity_name': 2200159, 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}, {'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",64,PRMT_00064,"SELECT  ac.customer_netsuite_id, ds.subsidiary_name,ac.customer_name,   ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_DUE_DATE,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_TRANSACTION_DATE,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3')     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('QUARTER', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('QUARTER', DATEADD('QUARTER', 1, CURRENT_DATE())) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","list unpaid invoices for customer id 2200159 in subsidiary DoorDash, Inc. in this quarter"
"list all credit memos for subsidiary DoorDash, Inc. in last 6 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",85,PRMT_00085,"SELECT    ds.SUBSIDIARY_NAME,  ai.CREDIT_MEMO_APPLIED_AMOUNT,      ai.NETSUITE_INVOICE_TRANSACTION_ID,      ai.INVOICE_TRANSACTION_DATE       FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON      ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3')     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -6, CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","list all credit memos for subsidiary DoorDash, Inc. in last 6 months"
"list all invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in last 3 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",87,PRMT_00087,"SELECT   ac.customer_name,   ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.INVOICE_DUE_AMOUNT,     ai.PAYMENT_RECEIVED_AMOUNT FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -3, CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","list all invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in last 3 months"
list all invoices for dris ticket# 1054 in last quarter,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",89,PRMT_00089,"WITH last_quarter AS (     SELECT          DATE_TRUNC('QUARTER', DATEADD(QUARTER, -1, CURRENT_DATE())) AS start_date,         DATE_TRUNC('QUARTER', CURRENT_DATE()) - INTERVAL '1 SECOND' AS end_date ) SELECT    ai.DRIS_TICKET_NUMBER,  ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      last_quarter lq ON      ai.INVOICE_TRANSACTION_DATE BETWEEN lq.start_date AND lq.end_date WHERE      ai.DRIS_TICKET_NUMBER = '1054' ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;",list all invoices for dris ticket# 1054 in last quarter
list all invoices for opportunity id 0062L00000WnokEQAR in this quarter,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",92,PRMT_00092,"SELECT    ai.CRM_OPPORTUNITY_ID ,  ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.IS_INVOICE_PAID,     ai.INVOICE_DUE_DATE FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai WHERE      ai.CRM_OPPORTUNITY_ID = '0062L00000WnokEQAR'     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('QUARTER', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('QUARTER', DATEADD(QUARTER, 1, CURRENT_DATE())) ORDER BY      ai.INVOICE_TRANSACTION_DATE LIMIT 1000;",list all invoices for opportunity id 0062L00000WnokEQAR in this quarter
"list all open invoices and credit memos for customer id 2200159 in this year
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_id', 'entity_name': 2200159, 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",94,PRMT_00094,"SELECT   ac.customer_netsuite_id,   ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.CREDIT_MEMO_APPLIED_AMOUNT,     ai.IS_INVOICE_PAID,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('YEAR', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('YEAR', DATEADD(YEAR, 1, CURRENT_DATE()))     AND ai.IS_INVOICE_PAID = FALSE LIMIT 1000;",list all open invoices and credit memos for customer id 2200159 in this year
list all outstanding invoices for opportunity id 0062L00000WnokEQAR in this quarter,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",103,PRMT_00103,"SELECT    ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.IS_INVOICE_DUE FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai WHERE      ai.CRM_OPPORTUNITY_ID = '0062L00000WnokEQAR'     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('QUARTER', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATEADD(QUARTER, 1, DATE_TRUNC('QUARTER', CURRENT_DATE())) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;",list all outstanding invoices for opportunity id 0062L00000WnokEQAR in this quarter
"list all overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in this quarter
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",108,PRMT_00108,"SELECT   customer_name,   ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_BUCKET,     ai.IS_INVOICE_DUE FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.IS_INVOICE_DUE = TRUE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('QUARTER', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('QUARTER', DATEADD(QUARTER, 1, CURRENT_DATE())) ORDER BY      ai.INVOICE_DUE_DATE DESC LIMIT 1000;","list all overdue invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in this quarter"
"list all unpaid invoices for business unit Marketplace in last 6 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'business_unit', 'entity_name': 'Marketplace', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",121,PRMT_00121,"SELECT    bu.business_unit_name,  ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_BUCKET,     ai.INVOICE_MEMO,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT bu     ON ai.BUSINESS_UNIT_FK = bu.BUSINESS_UNIT_PK WHERE      bu.BUSINESS_UNIT_PK IN ('c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4')     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -6, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1)) LIMIT 1000;",list all unpaid invoices for business unit Marketplace in last 6 months
"provide all unpaid invoices for brand Unilever in last 6 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",156,PRMT_00156,"SELECT      ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.INVOICE_DUE_AMOUNT,     ai.IS_INVOICE_PAID,     ac.CUSTOMER_NAME,     ac.BRAND FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.BRAND = 'Unilever'     AND ai.IS_INVOICE_PAID = FALSE     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -6, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1)) LIMIT 1000;
",provide all unpaid invoices for brand Unilever in last 6 months
provide the invoices for arsd ticket# 115936 in last 3 months,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",167,PRMT_00167,"SELECT      ai.DRIS_TICKET_NUMBER,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.PAYMENT_RECEIVED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.INVOICE_AGING_BUCKET,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ai.ARSD_TICKET_NUMBER = '115936'     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -3, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1))     ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;",provide the invoices for arsd ticket# 115936 in last 3 months
"show all outstanding invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in last 3 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",177,PRMT_00177,"SELECT    ac.customer_name,  ai.NETSUITE_INVOICE_TRANSACTION_ID,     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.IS_INVOICE_PAID,     ai.NETSUITE_INVOICE_URL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.IS_INVOICE_PAID = False     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -3, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1))ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","show all outstanding invoices for customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in last 3 months"
show me all overdue invoices for customer email monica.connery@unilever.com in this year,[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",183,PRMT_00183,"SELECT      ai.INVOICE_NUMBER,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_IN_DAYS,     ac.CUSTOMER_NAME,     ac.CUSTOMER_EMAIL FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.CUSTOMER_EMAIL = 'monica.connery@unilever.com'     AND ai.IS_INVOICE_DUE = TRUE     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('YEAR', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('YEAR', DATEADD(YEAR, 1, CURRENT_DATE())) ORDER BY      ai.INVOICE_DUE_DATE DESC LIMIT 1000;",show me all overdue invoices for customer email monica.connery@unilever.com in this year
"show me the invoices for customer id 2200159 in last 3 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_id', 'entity_name': 2200159, 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",195,PRMT_00195,"SELECT   ac.customer_netsuite_id,   ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_DATE,     ai.IS_INVOICE_PAID,     ai.INVOICE_DUE_AMOUNT,     ai.PAYMENT_RECEIVED_AMOUNT,     ai.INVOICE_AGING_BUCKET FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON      ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.INVOICE_TRANSACTION_DATE >= 
DATEADD(MONTH, -3, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1)) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;",show me the invoices for customer id 2200159 in last 3 months
"show the detailed summary of open invoices for brand Unilever in subsidiary DoorDash, Inc. for last 3 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}, {'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",207,PRMT_00207,"SELECT     ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.IS_INVOICE_PAID,     ai.INVOICE_AGING_BUCKET,     ds.SUBSIDIARY_NAME,     ac.CUSTOMER_NAME,     ac.BRAND FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3')     AND ac.BRAND = 'Unilever'     AND ai.IS_INVOICE_PAID = False     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -3, CURRENT_DATE()) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","show the detailed summary of open invoices for brand Unilever in subsidiary DoorDash, Inc. for last 3 months"
"show the detailed summary of unpaid invoices for brand Unilever in subsidiary DoorDash, Inc. for this quarter
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'subsidiary', 'entity_name': 'DoorDash, Inc.', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3']}, {'entity_type': 'brand', 'entity_name': 'Unilever', 'primary_keys': ['Unilever']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",214,PRMT_00214,"SELECT      ai.INVOICE_NUMBER,     ai.INVOICE_TRANSACTION_DATE,     ai.INVOICE_DUE_DATE,     ai.INVOICED_AMOUNT,     ai.INVOICE_DUE_AMOUNT,     ai.INVOICE_AGING_IN_DAYS,     ai.INVOICE_AGING_BUCKET,     ac.CUSTOMER_NAME,     ac.BRAND,     ds.SUBSIDIARY_NAME FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK JOIN      FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY ds ON ai.SUBSIDIARY_FK = ds.SUBSIDIARY_PK WHERE      ai.IS_INVOICE_PAID = FALSE     AND ac.BRAND = 'Unilever'     AND ds.SUBSIDIARY_PK IN ('c4ca4238a0b923820dcc509a6f75849b', 'eccbc87e4b5ce2fe28308fd9f2a7baf3')     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('QUARTER', CURRENT_DATE())     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('QUARTER', DATEADD('QUARTER', 1, CURRENT_DATE())) ORDER BY      ai.INVOICE_TRANSACTION_DATE DESC LIMIT 1000;","show the detailed summary of unpaid invoices for brand Unilever in subsidiary DoorDash, Inc. for this quarter"
"show the total amount of all invoices and payments for business unit Marketplace in last 6 months
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'business_unit', 'entity_name': 'Marketplace', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",220,PRMT_00220,"SELECT   bu.business_unit_name,   SUM(ai.INVOICED_AMOUNT) AS total_invoiced_amount,     SUM(ai.PAYMENT_RECEIVED_AMOUNT) AS total_payment_received_amount FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT bu ON ai.BUSINESS_UNIT_FK = bu.BUSINESS_UNIT_PK WHERE      bu.BUSINESS_UNIT_PK IN ('c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4')     AND ai.INVOICE_TRANSACTION_DATE >= DATEADD(MONTH, -6, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1)) group by bu.business_unit_name LIMIT 1000;",show the total amount of all invoices and payments for business unit Marketplace in last 6 months
"show the total amount of all invoices received from customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the past quarter
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'customer_name', 'entity_name': '73422 Conopco, Inc. d/b/a Unilever Food Solutions', 'primary_keys': ['80ac5986c2b31eee759c04efc038b1ea']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",221,PRMT_00221,"SELECT      SUM(ai.INVOICED_AMOUNT) AS total_invoiced_amount FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER ac ON ai.AR_CUSTOMER_FK = ac.AR_CUSTOMER_PK WHERE      ac.AR_CUSTOMER_PK = '80ac5986c2b31eee759c04efc038b1ea'     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('QUARTER', DATEADD(QUARTER, -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATE_TRUNC('QUARTER', DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1)) LIMIT 1000;","show the total amount of all invoices received from customer 73422 Conopco, Inc. d/b/a Unilever Food Solutions in the past quarter"
"show the total invoices for business unit Marketplace in last month
    
    Added_Context

    The following filtration_criteria has been extracted from the database. 
    Use only the given filtration_criteria for any of the SQL commands that involve filtering. 
    
    Do not use the anything but the ""primary_keys"" in the following filtration_criteria for the SQL filter condition.

    Do not skip any keys. 

    <filteration_criteria>
    [{'entity_type': 'business_unit', 'entity_name': 'Marketplace', 'primary_keys': ['c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4']}]
    </filteration_criteria>
    ",[],snowflake,"CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE AS (DRIS_TICKET_NUMBER Comment 'This is the Jira DRIS queue ticket number associated with the invoice.',
INVOICE_SENT_TO_CUSTOMER_CONTACTS Comment 'Emails of customer contacts to whom the invoice has been emailed..',
MARKET_FK Comment 'Foreign key to the DIM_MARKET table.',
CRM_OPPORTUNITY_ID Comment 'The internal ID of the Salesforce opportunity associated with this invoice. Is primairly used for Ads and Promos to track the sales opportunity id against the issued invoice.',
NETSUITE_INVOICE_TRANSACTION_ID Comment 'Unique identifier for each invoice transaction record in Netsuite.',
INVOICING_BUSINESS_LINE Comment 'classifies the different lines of business that DoorDash invoices its merchants and customers against.',
IS_INVOICE_PAID Comment 'True if the invoice is fully paid. False if the invoice is unpaid',
DELIVERIES_URL Comment 'URL to a file that contains all deliveries associated with this invoice..',
PAYMENT_RECEIVED_AMOUNT Comment 'Total payment amount applied against the invoice in USD. Use this field for all aggregates and reporting.',
INVOICE_DUE_DATE Comment 'Date by which payment for an invoice is expected to be received from the customer.',
INVOICE_TRANSACTION_DATE Comment 'Date on which the invoice transaction was created.',
IS_INVOICE_DUE Comment 'Boolean field that indicates whether the invoice is due. True means invoice is overdue, False means invoice is not due or invoice is current.',
AR_INVOICE_PK Comment 'Primary key for this table AR_INVOICE.',
CREDIT_MEMO_APPLIED_AMOUNT Comment 'Total value of the credit memos applied to offset the invoice in USD.Use this field for all aggregates and reporting.',
NETSUITE_INVOICE_URL Comment 'Netsuite URL of this invoice.',
INVOICE_DUE_AMOUNT Comment 'Amount in USD that is due or unpaid on the invoice. Use this field for all aggregates and reporting.',
SUBSIDIARY_FK Comment 'Foreign key to the DIM_SUBSIDIARY table.',
ARSD_TICKET_NUMBER Comment 'This is the Jira ARSD queue (AR Service Desk) ticket number associated with the invoice.',
INVOICED_AMOUNT Comment 'Amount Invoiced to the Customer in USD. Use this field for all aggregates and reporting.',
JOURNAL_ADJUSTMENT_AMOUNT Comment 'Cumulative value of all adjustments made through journal entries in USD.Use this field for all aggregates and reporting.',
INVOICE_AGING_BUCKET Comment 'Groups the invoice into buckets based on the elapsed time since the invoice was due, such as Current, 1-30 days, 31-60 days, 61-90 days and Over 90 days. Used primairly for an AR aging report.',
JOURNAL_ADJUSTMENT_AMOUNT_LOCAL Comment 'Cumulative value of all adjustments made through journal entries in local currency.Do not use for aggregates but use it to filter journals by local currency amount.',
INVOICE_MEMO Comment 'Memo that derscribes this invoice and services provided.',
AR_CUSTOMER_FK Comment 'Foreign key to AR_CUSTOMER table.',
INVOICED_IN_CURRENCY_CODE Comment 'Currency code in which the invoice is issued.',
INVOICE_NUMBER Comment 'Invoice Number or Document Number used by the users to search for the invoice',
INVOICED_AMOUNT_LOCAL Comment 'Amount Invoiced to the Customer in the local currency. Do not use for aggregates but use it to filter invoices by local currency amount.',
INVOICE_POSTING_PERIOD Comment 'Period on which invoice is posted in the accounting system.',
INVOICE_SENT_TO_CUSTOMER_DATE Comment 'Date on which the invoice was sent to the customer.',
BUSINESS_UNIT_FK Comment 'Foreign key to the DIM_BUSINESS_UNIT table.',
INVOICE_DUE_AMOUNT_LOCAL Comment 'Amount in local currency that is due or unpaid on the invoice. Do not use for aggregates but use it to filter invoices by local currency due amount.',
CREDIT_MEMO_APPLIED_AMOUNT_LOCAL Comment 'Total value of the credit memos applied to offset the invoice in local currency. Do not use for aggregates but use it to filter credit memos by local currency amount.',
PAYMENT_RECEIVED_AMOUNT_LOCAL Comment 'Total payment amount applied against the invoice in local currency.Do not use for aggregates but use it to filter payments by local currency amount.',
INVOICE_AGING_IN_DAYS Comment 'Number of days by which the payment is overdue on the invoice. A ""0"" or Negative value indicates that the invoice is current and not yet due.'
,FOREIGN KEY(""BUSINESS_UNIT_FK"") REFERENCES ""DIM_BUSINESS_UNIT""(""BUSINESS_UNIT_PK"")
,FOREIGN KEY(""MARKET_FK"") REFERENCES ""DIM_MARKET""(""MARKET_PK"")
,FOREIGN KEY(""AR_CUSTOMER_FK"") REFERENCES ""AR_CUSTOMER""(""AR_CUSTOMER_PK"")
,FOREIGN KEY(""SUBSIDIARY_FK"") REFERENCES ""DIM_SUBSIDIARY""(""SUBSIDIARY_PK""))
 Comment = 'The `AR_INVOICE` table is a secure view that provides detailed information about accounts receivable invoices. It includes key identifiers such as the invoice number and transaction ID, customer details, and financial metrics in both USD and Local Currency like the total invoiced amount, payments received, credit memo applied and journal adjustments made. The table also captures the invoice status, due dates, and aging brackets, helping to track and manage outstanding invoices efficiently. It also uses foreign keys to link to dimension tables like DIM_SUBSIDIARY,DIM_MARKET,DIM_BUSINESS_UNIT for additional information.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_CUSTOMER AS (CUSTOMER_NETSUITE_ID Comment 'A unique identifier for each customer within Netsuite.',
BRAND Comment 'The brand name to which the customer belongs.',
CUSTOMER_EMAIL Comment 'Primary contact email address of the customer.',
ADDITIONAL_CUSTOMER_EMAILS Comment 'Additional customer email addresses to whom communications are sent.',
CUSTOMER_ADDRESS Comment 'The billing address of the customer.',
NETSUITE_CUSTOMER_URL Comment 'URL to access the customers details in Netsuite.',
AR_CUSTOMER_PK Comment 'Primary key for the AR_CUSTOMER table.',
CUSTOMER_NAME Comment 'Name of the customer.',
BU_VERTICALS Comment 'Classification used to identify different customer types, such as Grocery or Alcoholvert by DoorDash.'
)
 Comment = 'The AR_CUSTOMER table is a secure view that contains comprehensive details about customers, including their contact information, address, brand, email and Netsuite URL.'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_MARKET AS (MARKET_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
MARKET_NAME Comment 'This field contains the name of the class or market.'
)
 Comment = 'This is a secure view that stores class details including market name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_DEPARTMENT AS (DEPARTMENT_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
DEPARTMENT_NAME Comment 'This field contains the name of the department.'
)
 Comment = 'This is a secure view that stores department details including department name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT AS (BUSINESS_UNIT_NAME Comment 'This field contains the name of the department or business_unit.',
BUSINESS_UNIT_PK Comment 'This is the primary key of the table, a unique identifier for each record.'
)
 Comment = 'This is a secure view that stores department details including business unit name'

CREATE OR REPLACE SECURE VIEW FINCOPILOT_CDM.COMMON.DIM_SUBSIDIARY AS (SUBSIDIARY_PK Comment 'This is the primary key of the table, a unique identifier for each record.',
SUBSIDIARY_NAME Comment 'This field contains the name of the subsidiary.'
)
 Comment = 'Secure view that represents subsidiary details including subsidary name.'",235,PRMT_00235,"SELECT      COUNT(ai.AR_INVOICE_PK) AS total_invoices FROM      FINCOPILOT_CDM.ACCOUNTS_RECEIVABLE.AR_INVOICE ai JOIN      FINCOPILOT_CDM.COMMON.DIM_BUSINESS_UNIT bu ON      ai.BUSINESS_UNIT_FK = bu.BUSINESS_UNIT_PK WHERE      bu.BUSINESS_UNIT_PK IN ('c4ca4238a0b923820dcc509a6f75849b', '45c48cce2e2d7fbdea1afc51c7c6ad26', '6512bd43d9caa6e02c990b0a82652dca', 'c20ad4d76fe97759aa27a0c99bff6710', 'd3d9446802a44259755d38e6d163e820', '1f0e3dad99908345f7439f8ffabdffc4', '6f4922f45568161a8cdf4ad2299f6d23', 'c74d97b01eae257e44aa9d5bade97baf', '70efdf2ec9b086079795c442636b55fb', 'd3d9446802a44259755d38e6d163e820', '6512bd43d9caa6e02c990b0a82652dca', '45c48cce2e2d7fbdea1afc51c7c6ad26', 'c20ad4d76fe97759aa27a0c99bff6710', '70efdf2ec9b086079795c442636b55fb', '6f4922f45568161a8cdf4ad2299f6d23', '1f0e3dad99908345f7439f8ffabdffc4')     AND ai.INVOICE_TRANSACTION_DATE >= DATE_TRUNC('MONTH', DATEADD('MONTH', -1, CURRENT_DATE()))     AND ai.INVOICE_TRANSACTION_DATE < DATEADD(MONTH, 1, DATEFROMPARTS(YEAR(CURRENT_DATE), MONTH(CURRENT_DATE), 1)) LIMIT 1000; 
",show the total invoices for business unit Marketplace in last month
